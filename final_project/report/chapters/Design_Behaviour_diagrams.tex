\section*{Behavior design}
\subsection*{Protocol state machines}
In this section we will explain, on a high abstraction level, what the protocol state machines does.
\subsubsection*{Webserver - Enterprise protocol}
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/protocol_state_machine_webserver_to_enterprise.png}
\caption{The communication protocol for buying toll tags}
\label{fig:protocol_state_machine_webserver_to_enterprise}
\end{figure}

\subsubsection*{Touchscreen protocol}
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/protocol_state_machine_touchscreen.png}
\caption{Protocol statemachine for the touchscreen}
\label{fig:protocol_state_machine_touchscreen}
\end{figure}
The diagram in \autoref{fig:protocol_state_machine_touchscreen} shows the communication protocol for getting the price for different vehicle types. It's used by customers if it is a credit card lane, and the cashier if it is a cash lane.

\subsubsection*{Antenna protocol}
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/protocol_state_machine_antenna.png}
\caption{The interface the antenna uses, to send out messages when cars are detected}
\label{fig:protocol_state_machine_antenna}
\end{figure}

\subsubsection*{Credit card reader protocol}
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/protocol_state_machine_tlc_to_ccr.png}
\caption{The interface for sending data about credit card information}
\label{fig:protocol_state_machine_tlc_to_ccr}
\end{figure}

\subsubsection*{Toll lane - bank protocol}
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/protocol_state_machine_tlc_to_bank.png}
\caption{Communications protocol between the bank and the credit card toll lane is shown}
\label{fig:protocol_state_machine_tlc_to_bank}
\end{figure}

\subsubsection*{Station server - normal toll lane checkout protocol}
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/protocol_state_machine_station_server_to_normal_lane_check_out.png}
\caption{Interface to allow toll lanes to validate tickets}
\label{fig:protocol_state_machine_station_server_to_normal_lane_check_out}
\end{figure}

\subsubsection*{Station server - enterprise server protocol}
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/protocol_state_machine_station_server_to_enterprise_server.png}
\caption{Interface to use for getting data for the generation of reports}
\label{fig:protocol_state_machine_station_server_to_enterprise_server}
\end{figure}

\subsubsection*{Express toll lane checkout - station server protocol}
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/protocol_state_machine_station_server with_toll_computer_check_out.png}
\caption{The communication protocol for checking out toll tag}
\label{fig:protocol_state_machine_station_server with_toll_computer_check_out}
\end{figure}

\subsubsection*{ticket reader protocol}
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/protocol_state_machine_ticket_reader.png}
\caption{The communication protocol for the ticket reader used during checkout for non-tag checkout}
\label{fig:protocol_state_machine_ticket_reader}
\end{figure}

\subsubsection*{enterprise server - station server protocol}
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/protocol_state_machine_enterprise_server_to_station_server.png}
\caption{The communication protocol between the enterprise server and the station server}
\label{fig:protocol_state_machine_enterprise_server_to_station_server}
\end{figure}


følgende diagram filer mangler (protocol state machines):
protocol_state_machine_station_server with_toll_computer_check_out
protocol_state_machine_enterprise_server_to_station_server
protocol_state_machine_enterprise_server_to_enterprise_client
protocol_state_machine_enterprise_client_enterprise_manager
protocol_state_machine_CR_TLC
protocol_state_machine_barrier


\subsection*{Life-cycle state machines}
\subsubsection*{Express Lane Check-in}
The ‘Express Check-in Toll Lane’-component, seen in \autoref{fig:life_cycle_statemachine_toll_lane_computer_express_check_in}, receives a message from the antenna to indicate that a vehicle with a toll tag has entered the lane. It reacts by sending a message to the station server to check that the tag is valid. If it receives true it tells the station server to check in the tag, opens the barrier, then closes it when the antenna informs it that the tag can no longer be detected.  Otherwise it goes to a faulty tag state and waits for a cashier to resolve the situation. 
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/life_cycle_statemachine_toll_lane_computer_express_check_in.png}
\caption{The life-cycle state machine for express lane check-in}
\label{fig:life_cycle_statemachine_toll_lane_computer_express_check_in}
\end{figure}

\subsubsection*{Express Lane Check-out}
The ‘Express Check-out Toll Lane’-component, seen in \autoref{fig:life_cycle_statemachine_toll_lane_computer_express_check_out}, receives a message from the antenna to indicate that a vehicle with a toll tag has entered the lane. It reacts by sending a message to the station server to check that the tag is checked in. If it receives true it tells the station server to check out the tag, opens the barrier, then closes it when the antenna informs it that the tag can no longer be detected.  Otherwise it goes to a faulty tag state and waits for a cashier to resolve the situation. 
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/life_cycle_statemachine_toll_lane_computer_express_check_out.png}
\caption{The life-cycle state machine for express lane check-out}
\label{fig:life_cycle_statemachine_toll_lane_computer_express_check_out}
\end{figure}

\subsubsection*{Normal Lane Check-in}
The ‘Normal Check-in Toll Lane’-component, seen in \autoref{fig:life_cycle_state_machine_toll_lane_computer}, waits for the touch screen to send information about a vehicle. It returns the price for that vehicle, then waits to receive payment via cash or credit card. If payment is received via card, it contacts the bank about the transaction. It then prints a ticket and opens the barrier long enough for the customer to pass.
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/life_cycle_state_machine_toll_lane_computer.png}
\caption{The life-cycle state machine for normal lane check-in}
\label{fig:life_cycle_state_machine_toll_lane_computer}
\end{figure}

\subsubsection*{Normal Lane Check-out}
The ‘Normal Check-out Toll Lane’-component, seen in \autoref{fig:life_cycle_state_machine_toll_computer_normal_lane}, waits for a ticket to be inserted. When it is, it contacts the station server to validate the ticket. If the ticket is valid, it opens the barrier, waits for the customer to leave, then closes the barrier. Otherwise it goes to an invalid ticket state and waits for a cashier to resolve the situation.
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/life_cycle_state_machine_toll_computer_normal_lane.png}
\caption{The life-cycle state machine for express lane check-out}
\label{fig:life_cycle_state_machine_toll_computer_normal_lane}
\end{figure}

\subsubsection*{Station server}
The ‘Station server’-component, seen in \autoref{fig:life_cycle_state_machine_station_server}, sends messages between the Toll Lane and the Enterprise Server.
\begin{figure}
\centering
\includegraphics[width=0.7\linewidth]{img/protocol_state_machine/life_cycle_state_machine_station_server.png}
\caption{The life-cycle state machine for express lane check-out}
\label{fig:life_cycle_state_machine_station_server}
\end{figure}


\subsubsection*{Enterprise server}
.